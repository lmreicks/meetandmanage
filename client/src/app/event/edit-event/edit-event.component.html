<form #form="ngForm" [formGroup]="eventForm" *ngIf="eventForm" class="pt-4">
    <div class="top-panel">
        <div class="form-group row">
            <div class="pl-3">
                <div class="font-awesome x-button" (click)="router.navigate(['dashboard'])">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            <div class="col-sm-9">
                <input class="form-control title"
                    [ngClass]="{ 'border-danger' : eventForm.get('Title').errors }"
                    type="text"
                    formControlName="Title"
                    placeholder="Add Title...">
            </div>
            <div class="col-sm-2">
                <button type="submit" (click)="createEvent(eventForm)" class="btn btn-success">{{ edit ? 'Edit' : 'Create' }} Event</button>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-sm-12 date-group ml-5">
                <div ngbDropdown class="date">
                    <input  class="form-control"
                            id="datepicker"
                            [ngClass]="{ 'border-danger': eventForm.get('StartDate').errors }"
                            [value]="formatDate(eventForm.get('StartDate').value)"
                            ngbDropdownToggle/>
                    <div ngbDropdownMenu aria-labelledby="datepicker">
                        <dl-date-time-picker
                            formControlName="StartDate"
                            [upIconClass]="''"
                            [minView]="'day'"
                            [startView]="'day'">
                        </dl-date-time-picker>
                    </div>
                </div>
                <div class="mx-2">
                    <ngb-timepicker formControlName="StartTime"
                                    [meridian]="true"
                                    [spinners]="false">
                    </ngb-timepicker>
                </div>
                <div class="mx-2">to</div>
                <div ngbDropdown class="date">
                    <input  class="form-control"
                            [ngClass]="{'border-danger': eventForm.get('EndDate').errors}"
                            id="datepicker"
                            [value]="formatDate(eventForm.get('EndDate').value)"
                            ngbDropdownToggle/>
                    <div ngbDropdownMenu aria-labelledby="datepicker">
                        <dl-date-time-picker
                            formControlName="EndDate"
                            [upIconClass]="''"
                            [minView]="'day'"
                            [startView]="'day'">
                        </dl-date-time-picker>
                    </div>
                </div>
                <div class="mx-2">
                    <ngb-timepicker formControlName="EndTime"
                                    [meridian]="true"
                                    [spinners]="false">
                    </ngb-timepicker>
                </div>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-sm-12 ml-5">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="allDayCheck" formControlName="AllDay">
                    <label class="form-check-label" for="allDayCheck">
                        All Day
                    </label>
                </div>
            </div>
        </div>
    </div>
    <div class="row px-4">
        <div class="col-sm-7">
            <div class="detail-tab">
                <div class="mb-1">Event Details</div>
            </div>
        </div>
        <div class="col-sm-5">
        <div class="detail-tab ml-3">
                <div class="mb-1">Guests</div>
            </div>
        </div>
    </div>
    <div class="hr"></div>
    <div class="bottom-panel row">
        <div class="col-sm-7 more-info">
            <div class="form-group row">
                <div class="col-sm-1">
                    <div class="font-awesome">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                </div>
                <div class="col-sm-11">
                    <location-input formControlName="Location"></location-input>
                </div>
            </div>
            <div class="form-group row" *ngIf="showNotification">
                <div class="col-sm-1">
                    <div class="font-awesome">
                        <i class="fa fa-bell"></i>
                    </div>
                </div>
                <div class="col-sm-3">
                    <input  type="number"
                            class="form-control"
                            min="0"
                            formControlName="NotificationValue">
                </div>
                <div ngbDropdown>
                    <button class="btn" id="notification" ngbDropdownToggle>
                        {{ getNotificationGranularity() }}
                    </button>
                    <div ngbDropdownMenu aria-labelledby="notification">
                        <li (click)="setNotification(0)" class="dropdown-item">
                            Minutes
                        </li>
                        <li (click)="setNotification(1)" class="dropdown-item">
                            Hours
                        </li>
                        <li (click)="setNotification(2)" class="dropdown-item">
                            Days
                        </li>
                        <li (click)="setNotification(3)" class="dropdown-item">
                            Weeks
                        </li>
                    </div>
                </div>
                <div class="col-sm-1">
                    <div class="font-awesome clickable" (click)="removeNotification()">
                        <i class="fas fa-times"></i>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-1">
                    <div class="font-awesome">
                        <i class="fas fa-paint-brush"></i>
                    </div>
                </div>
                <div ngbDropdown>
                    <div class="col-sm-11">
                        <button class="btn color-btn" id="color" ngbDropdownToggle>
                            <div class="color" [style.background-color]="eventForm.get('Color').value"></div>
                        </button>
                    </div>
                    <div ngbDropdownMenu aria-labelledby="color" class="color-dropdown">
                        <li *ngFor="let color of colors" class="dropdown-item" (click)="setColor(color)">
                            <div class="color" [style.background-color]="color"></div>
                        </li>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-1">
                    <div class="font-awesome">
                        <i class="fas fa-edit"></i>
                    </div>
                </div>
                <div class="col-sm-11">
                    <input  id="notes"
                            formControlName="Notes"
                            class="form-control"
                            placeholder="Add description...">
                </div>
            </div>
        </div>
        <div class="vl"></div>
        <div class="col-sm-5" formArrayName="Members">
            <div class="form-group"
                *ngFor="let member of getMembers(); let i = index">
                <div class="col-sm-11"
                    ngbDropdown>
                    <input  class="form-control"
                            [id]="i"
                            formControlName="{{i}}"
                            placeholder="Add Guest..."
                            (keyup)="memberSearch()"
                            ngbDropdownToggle>
                    <div    ngbDropdownMenu
                            [attr.aria-labelledby]="i"
                            #memberDropdown>
                        <li *ngIf="memberNotFound" id="not-found" class="dropdown-item">
                            Member Not Found
                        </li>
                        <li *ngFor="let user of users | filter: getMember(i)" class="dropdown-item" (click)="addMember(user, i)">
                            {{user.Name}}<br/>
                            <small>{{user.Email}}</small>
                        </li>
                    </div>
                </div>
                <div class="font-awesome col-sm-1 clickable" *ngIf="i < getMembers().length - 1" (click)="removeMember(i)">
                    <i class="fa fa-times"></i>
                </div>
            </div>
        </div>
    </div>
</form>